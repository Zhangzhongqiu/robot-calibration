function lbr = iiwa7_mdl(x,tau)

% Inertia
I1 = [0.016340516507626,	0,	0;
      0,	0.016173135489225,	0.003534;
      0,	0.003534,	0.0050259656272829];
    
I2 = [0.01634038425982,	0,	0;
     0,	0.016173111274838,	0.003534;
     0,	0.003534,	0.0050272806547582];
    
I3 = [0.016340393573046,	0,	0;
      0,	0.016172878444195,	-0.003533;
      0,	-0.003533,	0.0050275097601116];
    
I4 = [0.01634038053453,	0,	0;
      0,	0.016172980889678,	-0.003534;
      0,	-0.003534,	0.0050261416472495];
    
I5 = [0.009819190017879,	0,	0;
      0,	0.0090915467590094,	0.003093;
      0,	0.003093,	0.0037081523332745];
    
I6 = [0.0030111982487142,	0,	0;
      0,	0.003022399963811,	0;
      0,	0,	0.0034143980592489]; 
    
I7 = [0.0130522,	0,	0;
      0,	0.00711274,	0;
      0,	0,	0.0130522];
 
% Mass
M = [2.7; 2.7; 2.7; 2.7; 1.7; 1.6; 1.4];

% Center of Mass
RC = [0.00015950202941895, -0.025668799877167, -0.080369353294373;
     -3.4362077713013e-05, 0.0888432264328, -0.027725577354431;
     -5.4091215133667e-05, 0.027707517147064, -0.08038717508316;
      2.7269124984741e-05, 0.08891624212265, 0.025711119174957;
      3.361701965332e-05, -0.025357067584991, -0.095635056495667;
      0.00021129846572876, -0.0057910680770874, -0.0088013410568237;
     -0.0063236355781555, -0.0005452036857605, 0.060415387153625];

% DH-Parameters (meter)
d_bs = 0.34;
d_se = 0.4;
d_ew = 0.4;
d_wt = 0.126;

% Joint Limits
limits =  [-2.9671, 2.9671; ...
           -2.0944, 2.0944; ...
           -2.9671, 2.9671; ...
           -2.0944, 2.0944; ...
           -2.9671, 2.9671; ...
           -2.0944, 2.0944; ...
           -2.9671, 2.9671];

% create links
L(1) = Link('offset', 0+x(1)+x(22)*tau(1), 'd', d_bs+x(8),  'alpha', -0.5*pi+x(15), 'standard','I', I1, 'm', M(1), 'r', RC(1,:), 'Jm', 0); 
L(2) = Link('offset', 0+x(2)+x(23)*tau(2), 'd', 0+x(9),  'alpha', 0.5*pi+x(16), 'standard','I', I2, 'm', M(2), 'r', RC(2,:), 'Jm', 0);
L(3) = Link('offset', pi+x(3)+x(24)*tau(3), 'd', d_se+x(10),  'alpha', -0.5*pi+x(17), 'standard','I', I3, 'm', M(3), 'r', RC(3,:), 'Jm', 0);
L(4) = Link('offset', 0+x(4)+x(25)*tau(4), 'd', 0+x(11),  'alpha', 0.5*pi+x(18), 'standard','I', I4, 'm', M(4), 'r', RC(4,:), 'Jm', 0);
L(5) = Link('offset', pi+x(5)+x(26)*tau(5), 'd', d_ew+x(12),  'alpha', -0.5*pi+x(19), 'standard','I', I5, 'm', M(5), 'r', RC(5,:), 'Jm', 0);
L(6) = Link('offset', 0+x(6)+x(27)*tau(6), 'd', 0+x(13),  'alpha', 0.5*pi+x(20), 'standard','I', I6, 'm', M(6), 'r', RC(6,:), 'Jm', 0);
L(7) = Link('offset', 0+x(7)+x(28)*tau(7), 'd', d_wt+x(14),  'alpha',0+x(21), 'standard','I', I7, 'm', M(7), 'r', RC(7,:), 'Jm', 0);


lbr = SerialLink(L, 'name', 'iiwa', 'qlim', limits);

end